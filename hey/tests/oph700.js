var tests = {
    "tests": [
        {
            "qID": 601,
            "qName": "Нарушение целости зрительного нерва сопровождается",
            "rA": [
                "полной потерей зрения"
            ],
            "wA": [
                "перикорнеальной инъекцией сосудов",
                "повышением внутриглазного давления",
                "выраженным болевым синдромом"
            ]
        },
        {
            "qID": 602,
            "qName": "Оказание первой помощи при химических ожогах включает в себя все, кроме ...",
            "rA": [
                "инстилляций мидриатиков"
            ],
            "wA": [
                "обильного промывания конъюнктивальной полости водой в течение 5 30 минут",
                "инстилляций дезинфицирующих растворов",
                "инстилляций антидота"
            ]
        },
        {
            "qID": 603,
            "qName": "Разрыв радужки у ее основания называется",
            "rA": [
                "иридодиализ"
            ],
            "wA": [
                "хемоз",
                "рубеоз",
                "мидриаз"
            ]
        },
        {
            "qID": 604,
            "qName": "Первая ветвь тройничного нерва проходит",
            "rA": [
                "через верхнюю глазничную щель"
            ],
            "wA": [
                "через нижнюю глазничную щель",
                "через зрительный канал",
                "по краю орбиты"
            ]
        },
        {
            "qID": 605,
            "qName": "Глаз новорожденного имеет массу",
            "rA": [
                "3 4 г"
            ],
            "wA": [
                "1 г",
                "5 6 г",
                "7 8 г"
            ]
        },
        {
            "qID": 606,
            "qName": "Вход в орбиту закрывает",
            "rA": [
                "глазничная перегородка"
            ],
            "wA": [
                "слезный мешок",
                "средняя черепная ямка",
                "височная ямка"
            ]
        },
        {
            "qID": 607,
            "qName": "Отводящий нерв иннервирует",
            "rA": [
                "наружную прямую мышцу"
            ],
            "wA": [
                "внутренннюю прямую мышцу",
                "нижнюю косую мышцу",
                "нижнюю прямую мышцу"
            ]
        },
        {
            "qID": 608,
            "qName": "Функцию аддукции выполняют все мышцы, кроме",
            "rA": [
                "наружная прямая мышца"
            ],
            "wA": [
                "верхняя прямая мышца",
                "нижняя прямая мышца",
                "внутренняя прямая мышца"
            ]
        },
        {
            "qID": 609,
            "qName": "При параличе симпатического нерва наблюдается",
            "rA": [
                "небольшой птоз"
            ],
            "wA": [
                "полный птоз",
                "диплопия",
                "амблиопия"
            ]
        },
        {
            "qID": 610,
            "qName": "Слезные органы состоят",
            "rA": [
                "и того, и другого"
            ],
            "wA": [
                "из слезосекреторного аппарата",
                "из слезопроводящего аппарата",
                "ни того, ни другого"
            ]
        },
        {
            "qID": 611,
            "qName": "Слезные точки находятся",
            "rA": [
                "на вершине слезных сосочков"
            ],
            "wA": [
                "в латеральной части верхнего века",
                "на склере",
                "в области ресничного тела"
            ]
        },
        {
            "qID": 612,
            "qName": "Лимб   это ...",
            "rA": [
                "зона перехода роговицы в склеру"
            ],
            "wA": [
                "зона перехода ресничного тела в собственно сосудистую оболочку",
                "зона перехода ресничного тела в сетчатку полупрозрачная",
                "зона прикрепления глазодвигательных мышц"
            ]
        },
        {
            "qID": 613,
            "qName": "Хрусталик содержит",
            "rA": [
                "волокна"
            ],
            "wA": [
                "мезодермальные клетки",
                "ветви передней ресничной артерии",
                "сосуды конъюнктивы"
            ]
        },
        {
            "qID": 614,
            "qName": "Передней стенкой задней камеры глазного яблока является",
            "rA": [
                "радужка"
            ],
            "wA": [
                "хрусталик",
                "роговица",
                "сетчатка"
            ]
        },
        {
            "qID": 615,
            "qName": "Задняя граница ресничного тела соответствует на склере",
            "rA": [
                "местам прикрепления прямых мышц глаза"
            ],
            "wA": [
                "лимбу",
                "решетчатой пластинке",
                "экватору"
            ]
        },
        {
            "qID": 616,
            "qName": "К хориоидее изнутри прилегает",
            "rA": [
                "сетчатка"
            ],
            "wA": [
                "склера",
                "радужка",
                "хрусталик"
            ]
        },
        {
            "qID": 617,
            "qName": "Ядра палочко  и колбочконесущих зрительных клеток составляют",
            "rA": [
                "наружный зернистый слой"
            ],
            "wA": [
                "внутренний зернистый слой",
                "внутренний сетчатый слой",
                "ни одно из перечисленных"
            ]
        },
        {
            "qID": 618,
            "qName": "В области прохождения зрительного нерва отверстие затянуто",
            "rA": [
                "решетчатой пластинкой склеры"
            ],
            "wA": [
                "лимбом",
                "дренажной системой",
                "трабекулярной сетью"
            ]
        },
        {
            "qID": 619,
            "qName": "Область диска зрительного нерва",
            "rA": [
                "не содержит фоторецепторов"
            ],
            "wA": [
                "содержит колбочки",
                "содержит палочки",
                "все перечисленное"
            ]
        },
        {
            "qID": 620,
            "qName": "Для осмотра соединительной оболочки глаза необходимо",
            "rA": [
                "вывернуть веки"
            ],
            "wA": [
                "закапать 0,5% раствор дикаина",
                "надавить на слезные точки",
                "закапать 3% раствор колларгола"
            ]
        },
        {
            "qID": 621,
            "qName": "При исследовании проходящим светом источник света располагается",
            "rA": [
                "слева и сзади от больного"
            ],
            "wA": [
                "слева и спереди от больного",
                "справа и сзади от больного"
            ]
        },
        {
            "qID": 622,
            "qName": "Флюоресцентная ангиография позволяет",
            "rA": [
                "объективно регистрировать контрастированные флюоресцеином сосуды глазного дна"
            ],
            "wA": [
                "определить давление в центральной артерии сетчатки",
                "измерить внутриглазные дистанции",
                "определить внутриглазное давление"
            ]
        },
        {
            "qID": 623,
            "qName": "За нормальную остроту зрения равную 1,0",
            "rA": [
                "принята величина обратная углу зрения в 1 минуту"
            ],
            "wA": [
                "принята способность различения 300 оттенков",
                "принята величина обратная фокусному расстоянию в 1 метр",
                "называется пространство, которое одновременно воспринимается неподвижным глазом"
            ]
        },
        {
            "qID": 624,
            "qName": "Исследование поля зрения заключается",
            "rA": [
                "в определении его границ и выявлении дефектов зрительной функции внутри границ"
            ],
            "wA": [
                "в определении минимального угла зрения",
                "в определении способности к адаптации",
                "в определении бинокулярного зрения"
            ]
        },
        {
            "qID": 625,
            "qName": "Проекция в пространстве диска зрительного нерва называется ...",
            "rA": [
                "слепое пятно"
            ],
            "wA": [
                "гемианопсия",
                "макула",
                "экватор"
            ]
        },
        {
            "qID": 626,
            "qName": "Восприятие предметов, окрашенных в зеленый цвет называется ...",
            "rA": [
                "хлоропсия"
            ],
            "wA": [
                "эритропсия",
                "ксантопсия",
                "гемианопсия"
            ]
        },
        {
            "qID": 627,
            "qName": "При гиповитаминозе витамина А развивается",
            "rA": [
                "функциональная гемералопия"
            ],
            "wA": [
                "биназальная гемианопсия",
                "симптоматическая гемералопия",
                "битемпоральная гемианопсия"
            ]
        },
        {
            "qID": 628,
            "qName": "Одновременное зрение характеризуется тем, что",
            "rA": [
                "импульсы от одного и другого глаза воспринимаются одновременно, но нет слияния в единый зрительный образ"
            ],
            "wA": [
                "предмет видится единично, как бы одним глазом",
                "изображение передается в различные участки коры большого мозга и не происходит слияния в единый зрительный образ и возникает двоение",
                "одновременно можно видеть далеко и близко расположенные предметы"
            ]
        },
        {
            "qID": 629,
            "qName": "Для миопии характерно",
            "rA": [
                "снижение остроты зрения вдаль"
            ],
            "wA": [
                "снижение остроты зрения на близком расстоянии",
                "постоянное напряжение аккомодационного аппарата",
                "отсутствие бинокулярного зрения"
            ]
        },
        {
            "qID": 630,
            "qName": "Анизейкония   это ....",
            "rA": [
                "неодинаковая величина изображения предметов на сетчатке обоих глаз"
            ],
            "wA": [
                "неодинаковая рефракция обоих глаз",
                "сочетание двух видов аметропии в одном глазу",
                "снижение остроты зрения без органических изменений макулы"
            ]
        },
        {
            "qID": 631,
            "qName": "При оформлении рецепта на очки необходимо указать",
            "rA": [
                "все перечисленное"
            ],
            "wA": [
                "вид линзы",
                "оптическую силу линзы в диоптриях",
                "расстояние между центрами зрачков в миллиметрах"
            ]
        },
        {
            "qID": 632,
            "qName": "Пресбиопия клинически проявляется",
            "rA": [
                "отдалением ближайшей точки ясного зрения"
            ],
            "wA": [
                "снижением зрения вдаль",
                "отсутствием конвергенции",
                "приближением ближайшей точки ясного зрения"
            ]
        },
        {
            "qID": 633,
            "qName": "Осложнения миопии, требующие хирургического лечения",
            "rA": [
                "отслойка сетчатки"
            ],
            "wA": [
                "задняя стафилома",
                "миопический конус",
                "грубый пигментный очаг в области макулы"
            ]
        },
        {
            "qID": 634,
            "qName": "Блефарохалазис   это ...",
            "rA": [
                "свисающая над наружным углом глазной щели складка истонченной кожи верхнего века"
            ],
            "wA": [
                "хроническое пролиферативное воспаление хряща века",
                "укорочение и сужение глазной щели",
                "опущение верхнего века"
            ]
        },
        {
            "qID": 635,
            "qName": "Факторами, способствующими возникновению и развитию блефарита являются все, кроме",
            "rA": [
                "передача по типу неправильного доминантного наследования"
            ],
            "wA": [
                "запыленность и задымленность производственных помещений",
                "длительное пребывание в атмосфере раздражающих химических соединений",
                "некорригированный астигматизм"
            ]
        },
        {
            "qID": 636,
            "qName": "Клинические симптомы гонобленнореи новорожденных все, кроме:",
            "rA": [
                "изменение цвета радужки"
            ],
            "wA": [
                "выраженный синюшно багровый отек, веки закрыты",
                "кровянистое отделяемое цвета «мясных помоев»",
                "поражения роговицы"
            ]
        },
        {
            "qID": 637,
            "qName": "Формы аденовирусной Фарингоконъюнктивальной лихорадки все, кроме",
            "rA": [
                "геморрагическая"
            ],
            "wA": [
                "катаральная",
                "пленчатая",
                "фолликулярная"
            ]
        },
        {
            "qID": 638,
            "qName": "При птеригиуме рекомендуется",
            "rA": [
                "оперативное удаление"
            ],
            "wA": [
                "назначение антибиотиков",
                "назначение ферментов",
                "назначение антикоагулянтов"
            ]
        },
        {
            "qID": 639,
            "qName": "Специфическим признаком трахомы является",
            "rA": [
                "паннус"
            ],
            "wA": [
                "мидриаз",
                "рубеоз",
                "хемоз"
            ]
        },
        {
            "qID": 640,
            "qName": "Первичный очаг инфекции при паратрахоме",
            "rA": [
                "мочеполовые пути"
            ],
            "wA": [
                "сердечно сосудистая система",
                "центральная нервная система",
                "желудочно кишечный тракт"
            ]
        },
        {
            "qID": 641,
            "qName": "Для лекарственного конъюнктивита характерно все, кроме",
            "rA": [
                "наличие пленок в нижнем своде"
            ],
            "wA": [
                "гиперемия и отек конъюнктивы",
                "сосочковая гипертрофия конъюнктивы",
                "на коже век папуллезно везикулезные высыпания"
            ]
        },
        {
            "qID": 642,
            "qName": "Лечение птеригиума",
            "rA": [
                "при прогрессирующем врастании в роговицу показано оперативное лечение"
            ],
            "wA": [
                "консервативное лечение в виде противоотечной терапии",
                "ортоптическое лечение",
                "склеропластика"
            ]
        },
        {
            "qID": 643,
            "qName": "Кардинальный признак воспаления слезного мешка",
            "rA": [
                "выделение слизи или гноя из слезных точек при надавливании на область слезных точек"
            ],
            "wA": [
                "сращение век",
                "выворот слезных точек",
                "сужение глазной щели"
            ]
        },
        {
            "qID": 644,
            "qName": "Флегмона орбиты чаще всего начинается",
            "rA": [
                "как тромбофлебит глазничных вен"
            ],
            "wA": [
                "со склерита",
                "как конъюнктивит",
                "с блефарита"
            ]
        },
        {
            "qID": 645,
            "qName": "Основные признаки опухоли орбиты все, кроме",
            "rA": [
                "опущение верхнего века"
            ],
            "wA": [
                "прогрессирующий экзофтальм",
                "нарушение подвижности глазного яблока",
                "уменьшение или полное отсутствие репозиции глаза"
            ]
        },
        {
            "qID": 646,
            "qName": "Прозрачность роговицы нарушается вследствие",
            "rA": [
                "появления помутнений в различных слоях"
            ],
            "wA": [
                "появления рубеоза",
                "блефароспазма",
                "образования задних синехий"
            ]
        },
        {
            "qID": 647,
            "qName": "Симптомы, характерные для ползучей язвы роговицы все, кроме",
            "rA": [
                "наличие складки конъюнктивы"
            ],
            "wA": [
                "специфический вид язвы и способ ее распространения",
                "наличие иридоциклита",
                "наличие гипопиона"
            ]
        },
        {
            "qID": 648,
            "qName": "Склерозирующий кератит возникает",
            "rA": [
                "при наличии склерита"
            ],
            "wA": [
                "при наличии блефарита",
                "при наличии гриппа"
            ]
        },
        {
            "qID": 649,
            "qName": "Паренхиматозному сифилитическому кератиту свойственны",
            "rA": [
                "цикличность"
            ],
            "wA": [
                "снижение внутриглазного давления",
                "односторонность поражения",
                "неблагоприятный исход"
            ]
        },
        {
            "qID": 650,
            "qName": "Лечение кератитов должно включать все, кроме",
            "rA": [
                "снижения внутриглазного давления"
            ],
            "wA": [
                "борьбы с инфекцией",
                "воздействия на роговичный синдром",
                "стимуляции эпителизации дефекта"
            ]
        },
        {
            "qID": 651,
            "qName": "В исходе метагерпетического кератита развивается",
            "rA": [
                "обширное помутнение роговицы"
            ],
            "wA": [
                "болезнь Стилла",
                "отложение пигмента в области лимба",
                "задние синехии"
            ]
        },
        {
            "qID": 652,
            "qName": "При остром иридоциклите характерны",
            "rA": [
                "локальные ломящие боли в глазу"
            ],
            "wA": [
                "гнойное отделяемое из слезной точки",
                "иррадиирующие боли",
                "боли в одной половине головы"
            ]
        },
        {
            "qID": 653,
            "qName": "Сращение и заращение зрачка ведет",
            "rA": [
                "к нарушению связи между задней и передней камерами"
            ],
            "wA": [
                "к появлению помутнений",
                "к развитию панувеита",
                "к возникновению отслойки сетчатки"
            ]
        },
        {
            "qID": 654,
            "qName": "Воспаление хориоидеи может быть",
            "rA": [
                "очаговым и диссеминированным"
            ],
            "wA": [
                "древовидным и дисковидным",
                "поверхностным и глубоким",
                "все перечисленное"
            ]
        },
        {
            "qID": 655,
            "qName": "Старые хориоидальные очаги имеют",
            "rA": [
                "четкие границы и пигментацию"
            ],
            "wA": [
                "нечеткие границы и очаги кровоизлияния",
                "нечеткие границы и экссудацию",
                "экссудацию и кровоизлияния"
            ]
        },
        {
            "qID": 656,
            "qName": "Характерной особенностью болезни Илза являются",
            "rA": [
                "частые повторные кровоизлияния"
            ],
            "wA": [
                "преципитаты на эндотелии роговицы",
                "фолликулы на конъюнктиве век",
                "отложение пигмента в области лимба"
            ]
        },
        {
            "qID": 657,
            "qName": "Аниридия   это ...",
            "rA": [
                "отсутсвие радужки"
            ],
            "wA": [
                "образование нескольких зрачков отсутствие радужки",
                "отсутствие хрусталика",
                "просвечивание склеры"
            ]
        },
        {
            "qID": 658,
            "qName": "У детей наиболее часто встречается",
            "rA": [
                "центральная дегенерация сетчатки Штаргардта"
            ],
            "wA": [
                "друзы макулярной области",
                "сенильная макулодистрофия",
                "все перечисленные"
            ]
        },
        {
            "qID": 659,
            "qName": "При сахарном диабете в стекловидном теле отмечается",
            "rA": [
                "гемофтальм"
            ],
            "wA": [
                "наличие хлопьевидных помутнений в виде тонких волокон",
                "изменений нет",
                "разжижение"
            ]
        },
        {
            "qID": 660,
            "qName": "При лечении вторичной катаракты применяются",
            "rA": [
                "лазеры"
            ],
            "wA": [
                "ультразвук",
                "ультрафиолет",
                "инфракрасное излучение"
            ]
        },
        {
            "qID": 661,
            "qName": "Интракапсулярным способом хрусталик извлекают",
            "rA": [
                "хрусталик с капсулой"
            ],
            "wA": [
                "ядро хрусталика и хрусталиковые массы без капсулы",
                "после предварительной факофрагментации",
                "хрусталик выдавливают в стекловидное тело"
            ]
        },
        {
            "qID": 662,
            "qName": "Главным звеном в патогенезе закрытоугольной глаукомы является",
            "rA": [
                "блокада угла передней камеры корнем радужки"
            ],
            "wA": [
                "образование гониосинехий",
                "повреждение трабекулы",
                "повышение давления в системе передних цилиарных или вортикозных вен"
            ]
        },
        {
            "qID": 663,
            "qName": "Для врожденной глаукомы характерно",
            "rA": [
                "увеличение размеров глазного яблока"
            ],
            "wA": [
                "увеличение размеров хрусталика",
                "отслойка сетчатки",
                "диплопия"
            ]
        },
        {
            "qID": 664,
            "qName": "Симптом «очков» может указывать",
            "rA": [
                "на перелом основания черепа"
            ],
            "wA": [
                "на перелом нижней стенки орбиты",
                "на перелом у решетчатой пазухи",
                "на разрыв конъюнктивы"
            ]
        },
        {
            "qID": 665,
            "qName": "При контузиях глаза может наступить все, кроме",
            "rA": [
                "гипертрофии фолликул конъюнктивы"
            ],
            "wA": [
                "кровоизлияние",
                "отек сетчатки",
                "нарушение целости сетчатки"
            ]
        },
        {
            "qID": 666,
            "qName": "Особенно опасны отрывы век у внутреннего угла глаза в связи с повреждением",
            "rA": [
                "слезных канальцев"
            ],
            "wA": [
                "слезной железы",
                "мейбомиевых желез",
                "всего перечисленного"
            ]
        },
        {
            "qID": 667,
            "qName": "При установлении локализации инородных тел более надежным является сочетание",
            "rA": [
                "рентгенологического и ультразвукового метода"
            ],
            "wA": [
                "тонографии и экзоофтальмометрии",
                "периметрии и тонометрии",
                "всего перечисленного"
            ]
        },
        {
            "qID": 668,
            "qName": "При симпатическом воспалении возможно развитие",
            "rA": [
                "и того, и другого"
            ],
            "wA": [
                "бомбажа радужки",
                "вторичной глаукомы",
                "ни того, ни другого"
            ]
        },
        {
            "qID": 669,
            "qName": "Колликвационный некроз развивается при попадании в глаз",
            "rA": [
                "щелочей"
            ],
            "wA": [
                "раскаленного металла",
                "кипящей жидкости",
                "кислот"
            ]
        },
        {
            "qID": 670,
            "qName": "Патогенное действие сильного инфракрасного облучения заключается",
            "rA": [
                "в образовании катаракты"
            ],
            "wA": [
                "в развитии атрофии зрительного нерва",
                "в дистрофии радужки",
                "в развитии лентовидной дистрофии роговицы"
            ]
        }
    ]
};
var test = 0;
var amountTest = 0;
var iterGlobal = 0;
var exit = 0;
var key = [];
var selected = [];
var right = 0;
var wrongAnswers = [];
document.querySelector(".button").addEventListener("click", startQuiz);


var oToday = new Date();

function getDaysLeft(oDeadLineDate, oToday){
  return oDeadLineDate > oToday ? Math.ceil((oDeadLineDate - oToday) / (1000 * 60 * 60 * 24)) : null;
}

function MkDaysLeft(sDeadLineDate, sDeadLineText){
  var sTime = sDeadLineDate + " " + oToday.getHours() + ":" + oToday.getMinutes() + ":" + oToday.getSeconds();
  var oDeadLineDate = new Date(sTime);
  var nDaysLeft = getDaysLeft(oDeadLineDate, oToday);
  if (nDaysLeft){
    var sDaysLeft = String(nDaysLeft);
    var sDaysText = "дней";
    var nDaysLeftLength = sDaysLeft.length;
    if (sDaysLeft.charAt(nDaysLeftLength - 2) != "1"){
      if (sDaysLeft.charAt(nDaysLeftLength - 1) == "2" || sDaysLeft.charAt(nDaysLeftLength - 1) == "3" || sDaysLeft.charAt(nDaysLeftLength - 1) == "4") sDaysText = "дня";
      else if (sDaysLeft.charAt(nDaysLeftLength - 1) == "1") sDaysText = "день";
    }
    var sLeftText = sDaysText == "день" ? "остался" : "осталось";
    return sDeadLineText + " " + sLeftText + " " + nDaysLeft + " " + sDaysText + ".";
  }else return "Ух, ты! Пасхалка найдена! Значит ты сдашь!";
}
window.onload = function() {
document.querySelector(".status-timer").innerHTML = MkDaysLeft("May 25, 2018", "До тестов");
}


function startQuiz() {
	document.querySelector(".status").style.display = "block";
	document.querySelector(".status-timer").style.display = "none";
	document.querySelector(".checkbox-wrapper").style.display = "none";
	var variant = document.querySelector('.select').selectedIndex;
	console.log(variant);
	var varfile;
	switch(variant) {
		case 0:
			varfile = 'pulm.json';
			break;
		case 1:
			varfile = 'ibs.json';
			break;
		case 2:
			varfile = 'gbreum.json';
			break;
		case 3:
			varfile = 'klsn.json';
			break;
		case 4:
			varfile = 'gdcp.json';
			break;
		case 5:
			varfile = 'hep.json';
			break;
		case 6:
			varfile = 'nephr.json';
			break;
	}
	var xhr = new XMLHttpRequest();
	var xhrre;
	xhr.open('GET', varfile, false);
	xhr.send();
	if (xhr.status != 200) {
	  test = tests.tests;
	  alert( 'Нажми для продолжения' );
	} else {
	  xhrre = JSON.parse(xhr.responseText);
	  test = xhrre.tests;
	}
	if (document.querySelector(".checkbox").checked === true) {
	test = shuffle(test);
	}
	amountTest = test.length;
	iterGlobal = 0;
	exit = 0;
	key = [];
	selected = [];
	right = 0;
	wrongAnswers = [];
	document.querySelector(".button").removeEventListener("click", startQuiz);
	newQuestion();
	startTimer();
}
function newQuestion() {
	drawStatus();
	while (document.querySelector('.answers').hasChildNodes()) {
    	document.querySelector('.answers').removeChild(document.querySelector('.answers').lastChild);
	} // Очищаем предыдущие варианты	
	currentQuestion = test[iterGlobal]; // Текущий вопрос
	key = getKey(currentQuestion.rA.length, currentQuestion.wA.length); // Ключ к вопросу
	drawQuestion(currentQuestion, key);

	document.querySelector(".button").innerHTML = "ПОДТВЕРДИТЬ";
	document.querySelector(".button").addEventListener("click", compare);
	document.querySelector(".button").removeEventListener("click", newQuestion);
	if (document.querySelector(".select").getAttribute('hidden') == null) document.querySelector(".select").setAttribute('hidden', 'true');

}
function compare() {
	for (var i= 0; i < key.length; i++) {
		if (key[i] == 1) {
			document.getElementById(i + 1).className += " answers__answer_right";
		}
	}
	if (key.join(";") == selected.join(";")) {
		right++;
	} else {
		wrongAnswers.push(iterGlobal);
	}
	iterGlobal++;
  	if (iterGlobal < amountTest) {
 		document.querySelector(".button").innerHTML = "ДАЛЕЕ";
 		document.querySelector(".button").addEventListener("click", newQuestion);
 		document.querySelector(".button").removeEventListener("click", compare);
	} else {
		document.querySelector(".button").innerHTML = "ЗАКОНЧИТЬ";
 		document.querySelector(".button").addEventListener("click", drawEnd);
  		document.querySelector(".button").addEventListener("click", drawStatus);
 		document.querySelector(".button").removeEventListener("click", compare);
	}
}

function drawStatus() {
	var iter = iterGlobal + 1;
	if (iterGlobal == amountTest) iter = iterGlobal;
	var accuracy = right * 100 / iterGlobal;
	if (right == 0) {
		accuracy = 0;
	}
	var wrong = iterGlobal - right;
	document.querySelector(".status__index").innerHTML = iter + " / " + amountTest;
	document.querySelector(".status__accuracy").innerHTML = Math.round(accuracy) + "% | " + wrong + " неверно";
}


function drawQuestion(currentQuestion, key) {
	document.querySelector('.question__name').innerHTML = currentQuestion.qName;
	rA = shuffle(currentQuestion.rA);
	rAi = 0;
	wA = shuffle(currentQuestion.wA);
	wAi = 0;
	selected = [];
	amountAnswers = rA.length + wA.length;
	for (var i = 0; i < amountAnswers; i++) {
		if (key[i] == 0) {
			var answer = document.createElement('div');
			answer.className = "answers__answer answers__answer_unselected";
			answer.id = i + 1;
			answer.innerHTML = wA[wAi];
			wAi++;
			document.querySelector('.answers').appendChild(answer);
			document.querySelector('.answers').lastChild.addEventListener("click", getSelected);
			selected.push(0);
		} else {
			var answer = document.createElement('div');
			answer.className = "answers__answer answers__answer_unselected";
			answer.id = i + 1;
			answer.innerHTML = rA[rAi];
			rAi++;
			document.querySelector('.answers').appendChild(answer);
			document.querySelector('.answers').lastChild.addEventListener("click", getSelected);	
			selected.push(0);		
		}
	}
}

function drawEnd() {
	stopTimer();
	while (document.querySelector('.answers').hasChildNodes()) {
    document.querySelector('.answers').removeChild(document.querySelector('.answers').lastChild);
	}
	document.querySelector(".button").setAttribute('hidden', 'true');
	document.querySelector('.question__name').innerHTML = "РЕЗУЛЬТАТ";
	document.querySelector(".result").removeAttribute('hidden');
	document.querySelector(".bblock").removeAttribute('hidden');
	document.querySelector(".bblcok__button1").addEventListener("click", function() {window.location.href = "index.html" });
	document.querySelector(".bblcok__button3").addEventListener("click", function() {window.location.reload(false) });
	var accuracy = right * 100 / iterGlobal;
	document.querySelector('.result').innerHTML = Math.round(accuracy) + "%";
	if (wrongAnswers.length > 0) {
		document.querySelector(".bblcok__button2").addEventListener("click", reMatch);
	} else {
		document.querySelector(".bblcok__button2").className += " bblcok__button2_inactive";
	}
}

function reMatch() {
	startTimer();
	var newTest = [];
	for (var i=0; i < wrongAnswers.length; i++) {
		var iTest = wrongAnswers[i];
		newTest.push(test[iTest]);
	}
	test = newTest;
	iterGlobal = 0;
	amountTest = test.length;
	right = 0;
	key = [];
	selected = [];
	wrongAnswers = [];
	document.querySelector(".button").removeAttribute('hidden', 'true');
	document.querySelector(".result").setAttribute('hidden', 'true');
	document.querySelector(".bblock").setAttribute('hidden', 'true');
 	document.querySelector(".button").removeEventListener("click", drawEnd);
 	document.querySelector(".bblcok__button2").removeEventListener("click", reMatch);
	newQuestion();
}
function getSelected(elem) {
	selected[elem.target.id - 1] = 1;
	elem.target.className = "answers__answer answers__answer_selected";
	elem.target.removeEventListener("click", getSelected);
	elem.target.addEventListener("click", getUnSelected);
}
function getUnSelected(elem) {
	selected[elem.target.id - 1] = 0;
	elem.target.className = "answers__answer answers__answer_unselected";
	elem.target.removeEventListener("click", getUnSelected);
	elem.target.addEventListener("click", getSelected);
}
var timer;
function startTimer() {
	if (timer) clearInterval(timer);
	secs = 0;
	min = 0;
	document.querySelector('.status__time').innerHTML = min + ":0" + secs;
	timer = setInterval(
		function () {
			secs++;
			if (secs == 60) {
				secs = 0;
				min++;
			}
			if (secs < 10) {
				document.querySelector('.status__time').innerHTML = min + ":0" + secs;
			} else {
				document.querySelector('.status__time').innerHTML = min + ":" + secs;
			}
		},
		1000
	);
}
function stopTimer() {
    if (timer) clearInterval(timer); 	
}
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}
function getKey(rAL, wAL) {
	arr = [];
	for (rAL; rAL > 0; rAL--) {
		arr.push(1);
	}
	for (wAL; wAL > 0; wAL--) {
		arr.push(0);
	}
	shuffle(arr);
	return(arr);
}
/*
function newQuestion(i) {
	var currentTest = test[i];
	var amountAnswers = currentTest.rA.length + currentTest.wA.length;
	var key = getKey(currentTest.rA.length, currentTest.wA.length);
	var iterKey = 0;
	var iterWA = 0;
	var iterRA = 0;
	var allAnswers = [];
	for (iterKey; iterKey < amountAnswers; iterKey++) {
		if (key[iterKey] == 0) {
			allAnswers.push(currentTest.wA[iterWA]);
			iterWA++;
		} else {
			allAnswers.push(currentTest.rA[iterRA]);
			iterRA++;
		}
	}
	document.querySelector('.question__name').innerHTML = currentTest.qName;
	var amountAnswersIter = amountAnswers;
	var iter = 0;
	while (document.querySelector('.answers').hasChildNodes()) {
    	document.querySelector('.answers').removeChild(document.querySelector('.answers').lastChild);
	}	
	for (amountAnswersIter; amountAnswersIter > 0; amountAnswersIter--) {
		var answer = document.createElement('div');
		answer.className = "answers__answer answers__answer_unselected";
		answer.id = iter + 1;
		answer.innerHTML = allAnswers[iter];
		document.querySelector('.answers').appendChild(answer);
		document.querySelector('.answers').lastChild.addEventListener("click", getSelected);
		selected.push(0);
		iter++;
	}
	iter = 0;
	function compare(elem) {
		var iter = 0;
		console.log(key);
		for (iter; iter < key.length; iter++) {
			if (key[iter] == 1) {
				console.log(iter);
				document.getElementById(iter + 1).className += " answers__answer_right";
			}
		}
		if (selected == key) right++;
		elem.toElement.removeEventListener("click", compare);
		elem.toElement.addEventListener("click", goToNext);	
		elem.toElement.innerHTML = "ДАЛЕЕ";
	}
	function goToNext(elem) {
	newQuestion(2)
	elem.toElement.removeEventListener("click", goToNext);
	elem.toElement.addEventListener("click", compare);
	elem.toElement.innerHTML = "ПОДТВЕРДИТЬ";
	}
	document.querySelector('.button').addEventListener("click", compare);

}
newQuestion(1)
function getSelected(elem) {
	selected[elem.toElement.id - 1] = 1;
	console.log(selected);
	elem.toElement.className = "answers__answer answers__answer_selected";
	elem.toElement.removeEventListener("click", getSelected);
	elem.toElement.addEventListener("click", getUnSelected);
}
function getUnSelected(elem) {
	selected[elem.toElement.id - 1] = 0;
	console.log(selected);
	elem.toElement.className = "answers__answer answers__answer_unselected";
	elem.toElement.removeEventListener("click", getUnSelected);
	elem.toElement.addEventListener("click", getSelected);
}
*/
